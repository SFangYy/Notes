---
Project:
  - BuildPdb
title:
description:
source:
author:
tags:
  - xspdb
created: 2025-07-31 | 10:24
parent: Resource
branch:
---
# 003-GPT

好的，有多种方法可以查看一个可执行文件是静态链接还是动态链接，从简单直接到深入分析的都有。

以下是几种常用且有效的方法，推荐程度由高到低。

# 方法一：使用 ldd 命令 (最直接)

ldd (List Dynamic Dependencies) 是专门用来查看可执行文件动态链接库依赖的命令。它是判断链接类型的首选工具。
- 对于动态链接文件：ldd 会列出它所依赖的所有 .so 文件以及它们的路径。
    Bash
- 查看一个常见的命令，如 ls
```bash
ldd /bin/ls

#输出会是这样的：

linux-vdso.so.1 (0x00007ffc9dfb8000)
libselinux.so.1 => /lib/x86_64-linux-gnu/libselinux.so.1 (0x00007f3b1c1b9000)
libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007f3b1bfd4000)
libpcre2-8.so.0 => /lib/x86_64-linux-gnu/libpcre2-8.so.0 (0x00007f3b1bf3d000)
/lib64/ld-linux-x86-64.so.2 (0x00007f3b1c1e9000)
```


只要有输出列表，就说明是动态链接。

对于静态链接文件：ldd 会明确告诉你它不是一个动态可执行文件。
```Bash
    # 假设你有一个名为 static_program 的静态链接文件
    ldd ./static_program

    输出会是：

            statically linked

    或者 (在某些系统上):

            not a dynamic executable

```


## 方法二：使用 file 命令 (非常推荐)

file 命令能识别文件类型，它也能清晰地告诉你链接方式。

    对于动态链接文件：
    Bash

file /bin/bash

输出会包含 "dynamically linked" 字样，并且通常会指出所需的解释器（即动态加载器）。

/bin/bash: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, ...

对于静态链接文件：
Bash

    # 假设你有一个名为 static_program 的静态链接文件
    file ./static_program

    输出会明确包含 "statically linked" 字样。

    ./static_program: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, ...

方法三：使用 readelf 命令 (深入分析)

readelf 是一个功能强大的工具，用于显示有关 ELF 格式文件（Linux/Unix 下的可执行文件和库）的详细信息。

你只需要检查文件是否有一个“动态段”（dynamic section）。

    对于动态链接文件：它必须有一个动态段来列出所需的库和动态链接信息。
    Bash

readelf -d /bin/ls

你会看到一个包含 NEEDED、RPATH 等标签的列表，这些都表明它需要动态加载器来解析依赖。

Dynamic section at offset 0x2dd58 contains 27 entries:
  Tag        Type                         Name/Value
 0x0000000000000001 (NEEDED)             Shared library: [libselinux.so.1]
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]
 ...

对于静态链接文件：它没有动态段。
Bash

    # 假设你有一个名为 static_program 的静态链接文件
    readelf -d ./static_program

    你会得到一条明确的消息：

    There is no dynamic section in this file.

    这明确地证明了它是静态链接的。

方法四：使用 nm 命令 (间接方法)

nm 命令用于列出目标文件中的符号。通过观察未定义符号，我们也可以推断链接类型。

    对于动态链接文件：它会包含大量“未定义”（Undefined）的符号（通常标记为 U），这些符号是在运行时从共享库中解析的。
    Bash

# 使用 -D 选项查看动态符号
nm -D /bin/ls

输出会有一长串 U 开头的行，例如 U puts、U malloc 等。

          U __ctype_b_loc
          U __fpending
          U abort
...

对于静态链接文件：由于所有代码都已包含在内，几乎没有未定义的外部符号。
Bash

    nm ./static_program

    你可能会看到 nm: ./static_program: no symbols 或者只有很少的内部符号，但几乎不会看到对外部库函数（如 printf）的未定义引用。

总结

命令	如何判断动态链接	如何判断静态链接	推荐度
ldd	列出一系列 .so 依赖文件	显示 "statically linked" 或 "not a dynamic executable"	★★★★★ (最直接)
file	输出包含 "dynamically linked"	输出包含 "statically linked"	★★★★★ (非常清晰)
readelf -d	显示一个动态段（Dynamic section）	显示 "no dynamic section"	★★★★☆ (最准确)
nm -D	显示大量未定义符号 U	几乎没有或没有未定义符号	★★★☆☆ (间接，但有效)

对于日常使用，ldd 和 file 是最快、最方便的选择。如果你需要进行更底层的分析或编写脚本来判断，readelf 是最可靠的工具。